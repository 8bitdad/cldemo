#!/usr/bin/env bash

master_promises="/var/cfengine/masterfiles/promises.cf"

if ! grep 'cldemo.bundles' $master_promises > /dev/null; then
  sed -i 's/      service_catalogue,/      service_catalogue,\n                          \"cldemo\",\n                          @(cldemo.bundles),\n/' $master_promises
fi

if ! grep 'cldemo.promise_files' $master_promises >/dev/null; then
  sed -i 's!      "services/file_change.cf",!      "services/file_change.cf",\n                  "cldemo/promises.cf",\n                  @(cldemo.promise_files),!' $master_promises
fi

exit 0
